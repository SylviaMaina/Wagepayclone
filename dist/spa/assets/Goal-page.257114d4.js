import{Q as I}from"./QInput.286e18dc.js";import{Q as M}from"./QVirtualScroll.69496eb3.js";import{Y as N,q as n,_ as j,s as R,z as S,m as Y,r as J,o as L,c as O,a as e,w as l,al as c,b as o,F as Z,Z as w,a1 as p,a6 as i,aJ as f,a2 as V,v as q,P as H}from"./index.cde20d85.js";import{Q}from"./QCardActions.4f2104f5.js";import{Q as W}from"./QKnob.a223b6ff.js";import{Q as X,a as C}from"./QTabs.d6390e2c.js";import{u as ee,Q as te}from"./use-quasar.c0324529.js";import{Q as ae}from"./QTable.2e14d786.js";import{C as U}from"./ClosePopup.26502a4c.js";import"./uid.937d8ee7.js";import"./QItemLabel.45906cc2.js";import"./rtl.61fc98d8.js";import"./use-checkbox.d1d4d1c5.js";const le=o("h6",{class:"text-h6 q-pa-sm"},"Authenticate Transaction",-1),se=o("h6",{class:"text-subtitle2 text-grey-7"}," Use Pin to authenticate transaction ",-1),oe=o("h6",{class:"text-h6 q-pa-sm q-ml-sm"},"Cancel Saving",-1),ne=o("h6",{class:"text-subtitle2 text-grey-7"}," Please note that you'll incur 5% cancelllation fee if the saving was locked ",-1),re={class:"text-subtitle2 text-grey-7"},ie={class:"q-pa-md"},ue={class:"q-pa-md flex flex-center"},de={class:"text-center flex column",style:{width:"60%",height:"80%","align-items":"center","justify-content":"center"}},me={class:"text-h4 text-bold text-primary"},ce={class:"text-subtitle2 text-grey-8 q-mt-sm",style:{"font-size":"0.8rem"}},pe=o("h6",{class:"text-subtitle2 text-grey-8 q-mb-sm"},"Mature in 65 days",-1),fe="AutoSave",Ae={__name:"Goal-page",setup(ge){const G=["Card","Mobile"],k=N(),d=n(null),r=n({}),g=n(0),v=n(""),T=n(!0),E=n(""),h=n(!1),u=n(!1),m=n(!1),A=n(!1),P=j(),z=ee(),D=n([]),K=R();S(async()=>{try{await k.fetchUserProfile(),d.value=k.currentUser.id}catch(t){console.log("Error",t)}});const y=P.params.goalId;console.log(P.params);const b=async()=>{try{const t=await w.get(`/savings/${y}`);t.status===200?(u.value=!1,r.value=t.data.savingsGoal,D.value=t.data.savingsGoal.savings):(u.value=!1,console.log("Unexpected status:",t.status))}catch(t){u.value=!1,console.error("Error:",t.message)}};S(b);const $=async()=>{try{const t=await w.post("/save",{userId:d.value,source:v.value,amount:g.value,savingsId:y});(t.status=200)&&(z.notify({type:"positive",message:"Goal saved successfully!"}),b())}catch(t){console.log("Error",t)}},B=async()=>{try{const t=await w.post("/clear-saving",{userId:d.value,savingsId:y});(t.status=200)&&(z.notify({type:"positive",message:"Goal deleted successfully!"}),m.value=!1,K.push("/savings"),b())}catch(t){console.log("Error",t)}},x=Y(()=>!r.value||!r.value.targetAmount?0:r.value.goalProgress/r.value.targetAmount*100),F=[{name:"Date",required:!0,label:"Date",align:"left",field:t=>t.date},{name:"Amount",align:"center",label:"Amount",field:"Amount",sortable:!0,field:t=>t.amount},{name:"Total",label:"Total",field:"Total",sortable:!0,field:t=>t.source}];return(t,a)=>{const _=J("q-card-header");return L(),O(Z,null,[e(c,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=s=>h.value=s),position:"bottom"},{default:l(()=>[e(p,{class:"q-pa-lg"},{default:l(()=>[e(_,null,{default:l(()=>[o("h6",null,"Total target amount : "+i(r.value.targetAmount),1)]),_:1}),e(f,null,{default:l(()=>[e(I,{label:"Amount",hint:"Ksh 1,000",modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=s=>g.value=s)},null,8,["modelValue"]),e(M,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=s=>v.value=s),options:G,label:"Top-up From"},null,8,["modelValue"])]),_:1}),e(Q,{class:"bg-white text-primary flex justify-center q-my-lg"},{default:l(()=>[V(e(q,{rounded:"",style:{width:"9rem",height:"1rem","font-size":"0.8rem","border-radius":"40rem"},class:"q-px-sm",color:"primary",label:"Continue",onClick:$},null,512),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(c,{modelValue:u.value,"onUpdate:modelValue":a[4]||(a[4]=s=>u.value=s),position:"bottom",persistent:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(p,{class:"bg-white text-black",style:{width:"300px"}},{default:l(()=>[e(_,{align:"center"},{default:l(()=>[le,se]),_:1}),e(f,{class:"q-pt-none"},{default:l(()=>[e(I,{label:"OTP",mask:"****",hint:"1234"})]),_:1}),e(Q,{align:"center",class:"bg-white text-primary"},{default:l(()=>[V(e(q,{rounded:"",style:{width:"10rem",height:"2rem","font-size":"1rem"},color:"primary",label:"Complete",onClick:a[3]||(a[3]=s=>{t.inception=!1,t.secondDialog=!1})},null,512),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(c,{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=s=>m.value=s),position:"bottom",persistent:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(p,{class:"bg-white text-black",style:{width:"300px"}},{default:l(()=>[e(_,{align:"left"},{default:l(()=>[oe]),_:1}),e(f,{class:"q-pt-none"},{default:l(()=>[ne]),_:1}),e(Q,{align:"center",class:"bg-white text-primary"},{default:l(()=>[V(e(q,{rounded:"",style:{width:"10rem",height:"2rem","font-size":"1rem"},color:"primary",label:"Continue",onClick:B},null,512),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(c,{modelValue:A.value,"onUpdate:modelValue":a[6]||(a[6]=s=>A.value=s),position:"left",class:"q-mt-xl q-mx-lg","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(p,{style:{height:"10rem","border-radius":"1rem"}},{default:l(()=>[e(f,{class:"q-pt-none text-center q-mt-xl"},{default:l(()=>[o("h6",re," Your emergency saving of Ksh "+i(d.value.goalProgress)+" is now available for withdrawal ",1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),o("div",ie,[o("div",ue,[e(W,{"show-value":"","font-size":"10px",class:"q-ma-md",modelValue:x.value,"onUpdate:modelValue":a[7]||(a[7]=s=>x.value=s),size:"250px",thickness:.25,color:"primary","track-color":"grey-3"},{default:l(()=>[o("div",de,[o("h6",me,i(x.value.toFixed(0))+"% ",1),o("h6",ce," Ksh "+i(r.value.goalProgress)+" of Ksh "+i(r.value.targetAmount),1),pe,e(H,{name:"lock",size:"1.2rem"})])]),_:1},8,["modelValue"])]),o("div",null,[e(X,{modelValue:t.tab,"onUpdate:modelValue":a[11]||(a[11]=s=>t.tab=s),class:"bg-transparent"},{default:l(()=>[e(C,{name:"Topup",icon:"payments",label:"Topup",class:"text-grey-8 bg-transparent",onClick:a[8]||(a[8]=s=>h.value=!0)}),e(C,{name:"Cancel",icon:"close",label:"Cancel",onClick:a[9]||(a[9]=s=>m.value=!0),class:"text-grey-8 bg-transparent"}),e(C,{class:"q-ma-none q-pa-none"},{default:l(()=>[e(te,{modelValue:T.value,"onUpdate:modelValue":a[10]||(a[10]=s=>T.value=s),color:"primary",class:"","switch-label":""},null,8,["modelValue"]),o("div",{class:"q-toggle-label"},i(fe))]),_:1})]),_:1},8,["modelValue"])]),o("div",null,[e(ae,{title:r.value.goalName,rows:D.value,columns:F,"row-key":"name",flat:"",bordered:"",filter:E.value,"virtual-scroll":"",class:"q-ma-none q-pa-none"},null,8,["title","rows","filter"])])])],64)}}};export{Ae as default};

import{Q as y}from"./QInput.286e18dc.js";import{Y as Q,q as d,z as _,A as v,r as A,o as C,$ as I,w as o,a as t,aJ as h,b5 as g,v as U,a1 as z,al as B,b as m,Z as N}from"./index.cde20d85.js";import{u as S,Q as K}from"./use-quasar.c0324529.js";import{Q as $}from"./QCardActions.4f2104f5.js";const k=m("h6",{class:"text-h5 q-pl-sm"},"Salary advance request form",-1),P=m("h6",{class:"text-grey-7 q-pl-sm",style:{"font-size":"small"}}," Please note that this amount will be automatically deducted from your next salary ",-1),j=m("h6",{class:"text-grey-7 q-pl-sm",style:{"font-size":"small"}}," This will automatically deduct your loan from your card ",-1),F={__name:"Request-form",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(q,{emit:V}){const c=Q(),n=d(null),r=d(null),i=d(null),l=d(!1),u=S(),p=async()=>{try{await c.fetchUserProfile(),n.value=c.currentUser}catch(a){console.log("Error",a)}};_(p);const x=async()=>{try{const a=parseFloat(r.value);if(isNaN(a)||a<=0){u.notify({type:"negative",message:"Invalid amount!"});return}const e=n.value.salaryAdvances&&n.value.salaryAdvances.length>0?n.value.salaryAdvances[0].advanceId:null;if(!e){u.notify({type:"negative",message:"No advance found for the user!"});return}(await N.post("/request",{userId:n.value.id,amount:r.value,date:i.value,advanceId:e})).status===200?(u.notify({type:"positive",message:"Advance requested successfully"}),await p(),l.value=!1):(u.notify({type:"negative",message:"Something went "}),l.value=!1)}catch(a){console.log("Error",a)}},b=q,w=V;return v(()=>b.modelValue,a=>{l.value=a}),v(l,a=>{w("update:modelValue",a)}),(a,e)=>{const f=A("q-card-header");return C(),I(B,{modelValue:l.value,"onUpdate:modelValue":e[4]||(e[4]=s=>l.value=s),position:"bottom"},{default:o(()=>[t(z,{style:{"min-width":"350px",height:"40rem",display:"flex","flex-direction":"column","justify-content":"space-evenly"}},{default:o(()=>[t(f,null,{default:o(()=>[k,P]),_:1}),t(h,{class:"q-pt-none flex column justify-between",style:{height:"8rem"}},{default:o(()=>[t(y,{dense:"",modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),label:"Amount",placeholder:"Ksh 1000",autofocus:"",onKeyup:e[1]||(e[1]=g(s=>l.value=!1,["enter"]))},null,8,["modelValue"]),t(y,{dense:"",modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s),label:"Payable by",type:"date",placeholder:"11/11/2024",autofocus:"",onKeyup:e[3]||(e[3]=g(s=>l.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),t(h,null,{default:o(()=>[t(K,{label:"Autodeduct",color:"primary",class:"q-ma-none q-pa-none"}),j]),_:1}),t($,{align:"center",class:"text-primary"},{default:o(()=>[t(U,{rounded:"",size:"10px",class:"q-pa-xl",style:{width:"10rem",height:"2rem","font-size":"1rem"},color:"primary",label:"Submit",onClick:x})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{F as _};

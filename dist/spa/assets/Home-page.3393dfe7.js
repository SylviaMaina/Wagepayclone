import{Q as f}from"./QInput.286e18dc.js";import{Q as L,a as O,b as re,c as de}from"./QVirtualScroll.69496eb3.js";import{f as pe,m as me,h as ce,R as fe,Y as ve,q as u,z as be,r as G,o as h,c as M,a as e,w as t,al as _,b as o,a6 as p,$ as z,a1 as v,a7 as E,F as Y,v as g,a3 as k,aH as ye,aI as he,a4 as n,P as b,t as r,aJ as x,a2 as F,aK as _e,p as ge,e as xe,Z as J}from"./index.cde20d85.js";import{Q as m}from"./QItemLabel.45906cc2.js";import{Q as we}from"./QOptionGroup.8683911c.js";import{Q as W}from"./rtl.61fc98d8.js";import{Q as U}from"./QCardActions.4f2104f5.js";import{Q as Z,a as y}from"./QTabs.d6390e2c.js";import{Q as ke}from"./QToolbar.70a792cf.js";import{C as D}from"./ClosePopup.26502a4c.js";import{u as Ve}from"./use-quasar.c0324529.js";import{_ as Ce}from"./plugin-vue_export-helper.21dcd24c.js";import"./uid.937d8ee7.js";import"./use-checkbox.d1d4d1c5.js";import"./QRadio.8c4edce2.js";var qe=pe({name:"QToolbarTitle",props:{shrink:Boolean},setup(w,{slots:c}){const C=me(()=>"q-toolbar__title ellipsis"+(w.shrink===!0?" col-shrink":""));return()=>ce("div",{class:C.value},fe(c.default))}});const d=w=>(ge("data-v-794860df"),w=w(),xe(),w),Qe=d(()=>o("div",null,[o("h6",null,"Top-up your wallet")],-1)),Ae={style:{display:"flex","justify-content":"center"}},Te={style:{display:"flex","justify-content":"center"}},ze=d(()=>o("h6",null,"Shop with wallet",-1)),Ue={style:{display:"flex","justify-content":"center"}},Pe=d(()=>o("h6",{class:"text-subtitle2 text-grey-9"},"Total",-1)),Se=d(()=>o("h6",{class:"text-h6 text-weight-semibold"},"Ksh 70,000",-1)),Ie=d(()=>o("div",{class:"text-h6 q-pa-sm"},"Choose Payment Method",-1)),Be=d(()=>o("h6",{class:"text-h6 q-pa-sm"},"Authenticate Transaction",-1)),$e=d(()=>o("h6",{class:"text-subtitle2 text-grey-7"}," Use Pin to authenticate transaction ",-1)),je=d(()=>o("h6",{class:"q-px-lg q-pt-lg"},"New Bill",-1)),Ne={key:0,class:"full-width"},Re={class:"q-pa-lg bg-transparent"},Me={class:"text-center bg-transparent flex column justify-evenly",style:{height:"10rem"}},Ee=d(()=>o("h6",{class:"text-subtitle1 text-weight-light bg-transparent"}," Available Amount ",-1)),Fe={class:"text-h4 text-weigh-thin bg-transparent"},We={class:"text-subtitle2 bg-transparent"},De={class:"flex justify-between"},Ke=d(()=>o("h6",null,"Request Advance",-1)),He={class:"text-subtitle2 text-weight-light"},Le={class:"flex justify-between"},Oe={class:"text-subtitle2 text-black-2 q-mt-none text-weight-light"},Ge={class:"text-subtitle2 text-black-2 q-mt-none text-weight-light"},Ye=d(()=>o("h6",{class:"text-subtitle2 text-weight-bold"},"Due in 20 days",-1)),Je={__name:"Home-page",setup(w){const c=Ve(),C=ve(),i=u(null),K=u(!1),X=u(null),q=u(!1),Q=u(!1),P=u(!1),V=u(!1),A=u(!1),T=u(!1),S=u(!1),I=u(0),B=u(null),$=u(0),j=u(null),ee=async()=>{try{const s=parseFloat(I.value);if(isNaN(s)||s<=0){c.notify({type:"negative",message:"Invalid amount!"});return}const l=await J.post("/topup",{userId:i.value.id,source:B.value,amount:s});l.status===200&&(q.value=!1,i.value.availableAmount=l.data.user.availableAmount,i.value.transactions=l.data.user.transactions,c.notify({type:"positive",message:"Top-up successful!"}))}catch(s){console.error("Error",s),c.notify({type:"negative",message:"Top-up failed!"})}},te=async()=>{try{const s=parseFloat($.value);if(isNaN(s)||s<=0){c.notify({type:"negative",message:"Invalid amount!"});return}(await J.post("/withdraw",{userId:i.value.id,source:j.value.label,amount:s})).status===200&&(Q.value=!1,await H(),c.notify({type:"positive",message:"Top-up successful!"}))}catch(s){console.error("Error",s),c.notify({type:"negative",message:"Top-up failed!"})}},H=async()=>{K.value=!0;try{await C.fetchUserProfile(),i.value=C.currentUser,console.log(i.value)}catch(s){X.value=s.message||"Failed to fetch user profile"}finally{K.value=!1}};be(H);const le=()=>{q.value=!0},ae=()=>{Q.value=!0},oe=()=>{P.value=!0},se=["Income","Float","Collection"],ne=[{label:"Mobile",value:"Mobile",description:"Enter amount you with to withdraw",icon:"money"},{label:"Card A",value:"CardA",description:"Choose the card you wish to use",icon:"payments"}],ie=[{label:"Pay Bill",value:"bat",color:"primary"},{label:"Buy Goods",value:"friend",color:"primary"}];return(s,l)=>{const N=G("q-card-header"),ue=G("Router-link");return h(),M(Y,null,[e(_,{modelValue:q.value,"onUpdate:modelValue":l[2]||(l[2]=a=>q.value=a),position:"bottom"},{default:t(()=>[e(v,{class:"q-pa-lg"},{default:t(()=>[Qe,e(f,{modelValue:I.value,"onUpdate:modelValue":l[0]||(l[0]=a=>I.value=a),label:"Amount"},null,8,["modelValue"]),e(L,{modelValue:B.value,"onUpdate:modelValue":l[1]||(l[1]=a=>B.value=a),options:se,label:"Top-up From"},null,8,["modelValue"]),o("div",Ae,[e(g,{rounded:"",label:"Top Up",color:"primary","text-color":"white",size:"14px",onClick:ee,class:"q-mt-xl q-px-xl"})])]),_:1})]),_:1},8,["modelValue"]),e(_,{modelValue:Q.value,"onUpdate:modelValue":l[5]||(l[5]=a=>Q.value=a),position:"bottom"},{default:t(()=>[e(v,{class:"q-pa-lg"},{default:t(()=>[o("div",null,[o("h6",null,"Available: "+p(i.value.availableAmount),1)]),e(f,{modelValue:$.value,"onUpdate:modelValue":l[3]||(l[3]=a=>$.value=a),label:"Amount",placeholder:"Ksh 1,000"},null,8,["modelValue"]),e(L,{modelValue:j.value,"onUpdate:modelValue":l[4]||(l[4]=a=>j.value=a),options:ne,label:"Withdraw to",color:"teal",clearable:"","options-selected-class":"text-deep-orange"},{option:t(a=>[e(k,ye(he(a.itemProps)),{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(b,{name:a.opt.icon},null,8,["name"])]),_:2},1024),e(n,null,{default:t(()=>[e(m,null,{default:t(()=>[r(p(a.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"]),o("div",Te,[e(g,{rounded:"",label:"Withdraw",onClick:te,color:"primary","text-color":"white",size:"14px",class:"q-mt-xl q-px-xl"})])]),_:1})]),_:1},8,["modelValue"]),e(_,{modelValue:P.value,"onUpdate:modelValue":l[7]||(l[7]=a=>P.value=a),position:"bottom"},{default:t(()=>[e(v,{class:"q-pa-lg"},{default:t(()=>[ze,e(we,{options:ie,type:"radio",modelValue:s.group,"onUpdate:modelValue":l[6]||(l[6]=a=>s.group=a)},null,8,["modelValue"]),o("div",Ue,[e(g,{rounded:"",label:"Proceed",color:"primary","text-color":"white",size:"14px",class:"q-mt-xl q-px-xl"})])]),_:1})]),_:1},8,["modelValue"]),e(_,{modelValue:V.value,"onUpdate:modelValue":l[10]||(l[10]=a=>V.value=a),position:"bottom"},{default:t(()=>[e(v,{style:{height:"25rem",display:"flex","flex-direction":"column","justify-content":"space-between"}},{default:t(()=>[e(x,{align:"right"},{default:t(()=>[e(b,{name:"add",size:"30px",onClick:l[8]||(l[8]=a=>S.value=!0)})]),_:1}),e(x,{class:"q-pt-none"},{default:t(()=>[e(W,{style:{height:"8rem",display:"flex","flex-direction":"column","justify-content":"space-between"}},{default:t(()=>[e(k,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(b,{size:"30px",name:"money"})]),_:1}),e(n,null,{default:t(()=>[e(m,null,{default:t(()=>[r("Shop Rent")]),_:1}),e(m,{caption:""},{default:t(()=>[r("Ksh 50,000")]),_:1})]),_:1}),e(n,{side:""},{default:t(()=>[e(O)]),_:1})]),_:1}),e(k,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(b,{size:"30px",name:"money"})]),_:1}),e(n,null,{default:t(()=>[e(m,null,{default:t(()=>[r("House Rent")]),_:1}),e(m,{caption:""},{default:t(()=>[r("Ksh 20,000")]),_:1})]),_:1}),e(n,{side:""},{default:t(()=>[e(O)]),_:1})]),_:1})]),_:1})]),_:1}),e(x,{align:"center"},{default:t(()=>[Pe,Se]),_:1}),e(U,{align:"center"},{default:t(()=>[e(g,{rounded:"",style:{width:"10rem",height:"3rem","font-size":"1rem"},color:"primary",label:"Pay",onClick:l[9]||(l[9]=a=>A.value=!0)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(_,{modelValue:A.value,"onUpdate:modelValue":l[12]||(l[12]=a=>A.value=a),position:"bottom","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(v,{class:"bg-white text-black",style:{width:"300px"}},{default:t(()=>[e(N,null,{default:t(()=>[Ie]),_:1}),e(x,{class:"q-pt-none"},{default:t(()=>[e(W,{style:{height:"8rem",display:"flex","flex-direction":"column","align-items":"center","justify-content":"space-between"}},{default:t(()=>[e(k,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(b,{size:"30px",name:"money"})]),_:1}),e(n,null,{default:t(()=>[e(m,null,{default:t(()=>[r("Mobile")]),_:1})]),_:1})]),_:1}),e(k,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(b,{size:"30px",name:"payment"})]),_:1}),e(n,null,{default:t(()=>[e(m,null,{default:t(()=>[r("Card")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{align:"center",class:"bg-white text-primary"},{default:t(()=>[F(e(g,{rounded:"",style:{width:"10rem",height:"2rem","font-size":"1rem"},color:"primary",label:"Pay",onClick:l[11]||(l[11]=a=>T.value=!0)},null,512),[[D]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(_,{modelValue:T.value,"onUpdate:modelValue":l[14]||(l[14]=a=>T.value=a),position:"bottom",persistent:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(v,{class:"bg-white text-black",style:{width:"300px"}},{default:t(()=>[e(N,{align:"center"},{default:t(()=>[Be,$e]),_:1}),e(x,{class:"q-pt-none"},{default:t(()=>[e(f,{label:"OTP",mask:"****",hint:"1234"})]),_:1}),e(U,{align:"center",class:"bg-white text-primary"},{default:t(()=>[F(e(g,{rounded:"",style:{width:"10rem",height:"2rem","font-size":"1rem"},color:"primary",label:"Complete",onClick:l[13]||(l[13]=a=>{V.value=!1,A.value=!1})},null,512),[[D]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(_,{modelValue:S.value,"onUpdate:modelValue":l[16]||(l[16]=a=>S.value=a),position:"bottom"},{default:t(()=>[e(v,{style:{height:"40rem",display:"flex","flex-direction":"column","justify-content":"space-between"}},{default:t(()=>[e(N,null,{default:t(()=>[je]),_:1}),e(x,{class:"q-pa-lg",style:{height:"30rem",display:"flex","flex-direction":"column","justify-content":"space-between"}},{default:t(()=>[e(f,{label:"Bill Name"}),e(f,{label:"Account Number"}),e(f,{label:"Amount"}),e(f,{label:"Recepient Phone(optional)"}),e(f,{label:"Recepient Email"})]),_:1}),e(U,{align:"center",class:"bg-white text-primary q-mb-lg"},{default:t(()=>[F(e(g,{rounded:"",style:{width:"10rem",height:"2rem","font-size":"1rem"},color:"primary",label:"Add Bill",onClick:l[15]||(l[15]=a=>T.value=!0)},null,512),[[D]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i.value?(h(),M("div",Ne,[o("div",Re,[o("div",Me,[Ee,o("h6",Fe," Kes "+p(i.value.availableAmount),1),o("h6",We," Savings: ksh "+p(i.value.savings),1)]),o("div",null,[e(Z,{class:"bg-transparent q-ma-sm"},{default:t(()=>[e(y,{name:"Top-Up",icon:"wallet",label:"Top-Up",class:"text-green-9 bg-transparent",onClick:l[17]||(l[17]=a=>le())}),e(y,{name:"Withdraw",icon:"inbox",label:"Withdraw",class:"text-red-9 bg-transparent",onClick:l[18]||(l[18]=a=>ae())}),e(y,{name:"Shop",icon:"shop",label:"Shop",class:"text-black bg-transparent",onClick:l[19]||(l[19]=a=>oe())}),e(y,{name:"Save",icon:"savings",label:"Movies",class:"text-yellow-9 bg-transparent"})]),_:1})]),i.value?(h(),z(v,{key:0,class:"my-card q-mt-lg"},{default:t(()=>[(h(!0),M(Y,null,_e(i.value.salaryAdvances,(a,R)=>(h(),z(x,{class:"my-card",key:R},{default:t(()=>[o("div",De,[Ke,e(ue,{to:"/advance"},{default:t(()=>[e(b,{name:"add",size:"30px"})]),_:1})]),o("div",null,[o("h6",He," You are eligible for kes "+p(a.amount),1),o("div",null,[e(re,{value:a.borrowedAmount/a.availableCredit,color:"primary","track-color":"black",rounded:"",class:"q-mt-sm","track-size":"8px",size:"12px"},null,8,["value"]),o("div",Le,[o("h6",Oe," Borrowed "+p(a.borrowedAmount),1),o("h6",Ge," Available "+p(a.remainingAmount),1)]),Ye])])]),_:2},1024))),128))]),_:1})):E("",!0),o("div",null,[e(Z,{class:"bg-transparent q-my-lg"},{default:t(()=>[e(y,{name:"Electricity",icon:"timeline",label:"Electricity",class:"text-grey-9 bg-transparent"}),e(y,{name:"Cable",icon:"paid",label:"Cable",class:"text-grey-9 bg-transparent"}),e(y,{name:"Rent",icon:"savings",label:"Rent",onClick:l[20]||(l[20]=a=>V.value=!0),class:"text-yellow-9 bg-transparent"}),e(y,{name:"More",icon:"apps",label:"More",onClick:l[21]||(l[21]=a=>V.value=!0),class:"text-yellow-9 bg-transparent"})]),_:1})]),o("div",null,[e(ke,{class:"text-black"},{default:t(()=>[e(qe,null,{default:t(()=>[r("Transactions")]),_:1})]),_:1}),i.value.transactions?(h(),z(W,{key:0},{default:t(()=>[e(de,{type:"table",style:{"max-height":"500px"},"virtual-scroll-item-size":48,"virtual-scroll-sticky-size-start":48,"virtual-scroll-sticky-size-end":32,items:i.value.transactions},{default:t(({item:a,index:R})=>[(h(),z(k,{key:R},{default:t(()=>[e(n,{top:"",class:"q-pa-none"},{default:t(()=>[e(b,{name:"inbox",color:"red",size:"30px"})]),_:1}),e(n,null,{default:t(()=>[e(m,null,{default:t(()=>[r(p(a.type),1)]),_:2},1024),e(m,{caption:""},{default:t(()=>[r(p(a.date),1)]),_:2},1024)]),_:2},1024),e(n,null,{default:t(()=>[e(m,null,{default:t(()=>[r("-ksh "+p(a.amount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))]),_:1},8,["items"])]),_:1})):E("",!0)])])])):E("",!0)],64)}}};var ct=Ce(Je,[["__scopeId","data-v-794860df"]]);export{ct as default};
